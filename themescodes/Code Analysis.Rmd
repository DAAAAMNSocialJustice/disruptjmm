---
title: "Data Analysis"
output: html_document
date: "2023-01-02"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, echo=FALSE, message=FALSE}
# packages
library(tidyverse) 
library(tidytext) 
library(rtweet)
library(ggplot2)
library(knitr)

#Read in file
DisruptCoded<-read.csv("./Final Coding.csv")


#set up a summary dataframe and store theme counts and frequencies
Themes<-c("Self.organization", "Building.community","Broadening.the.counterpublic", "Creating.change.in.math", "SJEDI")
Nper<-c(sum(DisruptCoded$Self.organization), sum(DisruptCoded$Building.community), sum(DisruptCoded$Broadening.the.counterpublic), sum(DisruptCoded$Creating.change.in.math), sum(DisruptCoded$SJEDI))
Freqper <- Nper/nrow(DisruptCoded)
ThemeSummary<-data.frame(Nper, Freqper)
row.names(ThemeSummary)<-Themes

#Examine only the non-RT
#original content tweets (OCT) are original tweets (OT), replies, and quote tweets (QT) 
whichRT<-str_detect(DisruptCoded$text, "^RT ")
OCT<-filter(DisruptCoded,!whichRT)
NperOCT<-c(sum(OCT$Self.organization), sum(OCT$Building.community), sum(OCT$Broadening.the.counterpublic), sum(OCT$Creating.change.in.math), sum(OCT$SJEDI))
FreqperOCT <- NperOCT/nrow(OCT)
ThemeSummary <- cbind(ThemeSummary, NperOCT, FreqperOCT)
```

How many tweets were in each bucket?
```{r, echo=FALSE}
kable(ThemeSummary, col.names=c("Number of tweets", "Frequency of tweets", "Number of original tweets", "Frequency of original tweets"),digits=c(0,2,0,2,0))
```

```{r, echo=FALSE}
#Tweet subsets of each code
SOtweets<-filter(DisruptCoded,Self.organization == 1)
BCtweets<-filter(DisruptCoded,Building.community == 1)
BtCtweets<-filter(DisruptCoded,Broadening.the.counterpublic == 1)
CCtweets<-filter(DisruptCoded,Creating.change.in.math == 1)
SJtweets<-filter(DisruptCoded,SJEDI == 1)

#TimeSeries of Tweets by hours
#DisruptCoded<-cbind(DisruptCoded, time <- as.POSIXct(strptime(DisruptCoded$created_at, "%a, %d %b %Y %H:%M:%S %z", tz = "GMT")))

```

How many tweets were tagged indigenous?
```{r, echo=FALSE}
#Filter out  tweets by ones that have "indigenous" in the SJEDI.code column
indigenousTweets=filter(OCT,grepl("indigenous",SJEDI.code))
nrow(indigenousTweets)
```

How many were tagged Talk support?
```{r, echo=FALSE}
talkSupportTweets=filter(OCT,grepl("talk support",BC.code))
nrow(talkSupportTweets)
```

What about Strategic Planning?
```{r, echo=FALSE}
#One liner
nrow(filter(OCT,grepl("strategic planning",SO.code)))
```
