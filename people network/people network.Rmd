---
title: "R Notebook"
output:
  html_document:
    df_print: paged
---
## Mise en place - Getting your workspace ready

Load the igraph package
```{r}
# load igraph
library(igraph)
```

# Create Graph Object
## This is the twitter network of users. Users are connected if there RT or reply or a quote tweet.

### Read data file
```{r}
#read file in as members
mt_edgelist <- read.csv("../data cleaning/people-edge-list.csv")
View(mt_edgelist)
head(mt_edgelist)
```
Note: the sender is in the first column and receiver in the second

```{r}
#create a matrix, just of CRSE and FAC1
send_interact <- cbind(Sender = mt_edgelist$Sender,Interactor = mt_edgelist$Receiver)

# check it out
head(send_interact)
dim(send_interact)
```

### Define network from edgelist
```{r}
# make a graph object
mathpeeps.g <- graph.edgelist(send_interact, directed = TRUE)
```


### Visualize the group network
Use the igraph documentation @igraph to comment what the code below is doing:

* [layout_with_fr]{https://igraph.org/r/doc/layout_with_fr.html}  
* [edge_attr]{https://igraph.org/r/doc/edge_attr.html}  Then run the following code & revise your code as necessary.  

```{r}
#plot features
la <- layout_with_fr(mathpeeps.g)
e.wt <- edge_attr(mathpeeps.g, "weight")

#plot group network
plot(mathpeeps.g, layout=la, vertex.size=10,edge.width=e.wt,vertex.label=V(mathpeeps.g)$name, edge.arrow.size = .2)
```
```{r}
png("people.png", width = 465, height = 225, units='mm', res = 300)
plot(mathpeeps.g, layout=la, vertex.size=2,edge.width=e.wt,vertex.label=V(mathpeeps.g)$name, edge.arrow.size = .2)
dev.off()
```


### Network Statistics

```{r}
#Betweenness of top 10 in order
btwn.fac <- betweenness(fac.g)
names(btwn.fac) <- V(fac.g)$name
ind <- order(-btwn.fac)
btwn.fac[ind][1:10]

#eigenvector centrality of top 10
cent.eig <- evcent(fac.g)
names(cent.eig$vector) <- V(fac.g)$name
ind <- order(-cent.eig$vector)
cent.eig$vector[ind][1:10]

``` 


# Wrap up
